<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 56 Conditional mutating and summarising | DoSS Toolkit</title>

    <meta name="author" content="Various authors" />
  
   <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 56 Conditional mutating and summarising | DoSS Toolkit" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 56 Conditional mutating and summarising | DoSS Toolkit" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/header-attrs-2.10/header-attrs.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.2.5.1/tabs.js"></script>
    <script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="bs4_style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">DoSS Toolkit</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="conditional-mutating-and-summarising" class="section level1" number="56">
<h1><span class="header-section-number">Chapter 56</span> Conditional mutating and summarising</h1>
<p><em>Written by Mariam Walaa.</em></p>
<div id="introduction-52" class="section level2" number="56.1">
<h2><span class="header-section-number">56.1</span> Introduction</h2>
<p>In this lesson, you will learn how to:</p>
<ul>
<li>Use <code>across()</code> with <code>summarise()</code></li>
<li>Use <code>mutate_if()</code></li>
<li>Use <code>if_else()</code> and <code>na_if()</code></li>
</ul>
<p>Prerequisite skills include:</p>
<ul>
<li>Familiarity with <code>summarize()</code> and <code>mutate()</code></li>
<li>Familiarity with conditional statements <code>if_else()</code></li>
</ul>
<p>Highlights:</p>
<ul>
<li>Use <code>across()</code> to summarize across a defined selection of columns</li>
<li>Mutate column types based on conditions using <code>mutate_if()</code></li>
<li>Mutate columns based on conditions using <code>if_else()</code> and <code>na_if()</code> within <code>mutate()</code></li>
</ul>
</div>
<div id="overview-9" class="section level2" number="56.2">
<h2><span class="header-section-number">56.2</span> Overview</h2>
<p>This section will demonstrate how to use the <code>summarise()</code> function with <code>across()</code> to
summarize variables and groups within a variable in a data set. We will be looking at a
data set of Broadway shows with variables about the performances, attendance, and revenue
for theaters that are part of The Broadway League. You can learn more about the data set
provided by Alex Cookson in <a href="https://github.com/tacookson/data">the dataset repository</a> as
well as this corresponding <a href="https://www.alexcookson.com/post/most-successful-broadway-show-of-all-time/">blog
post</a>.</p>
<div id="video-3" class="section level3" number="56.2.1">
<h3><span class="header-section-number">56.2.1</span> Video</h3>
<p><img src="https://youtu.be/3mmbPjgzzeY" /></p>
</div>
</div>
<div id="questions-6" class="section level2" number="56.3">
<h2><span class="header-section-number">56.3</span> Questions</h2>
<p>Lets start with loading the tidyverse and looking at the data.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="conditional-mutating-and-summarising.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="conditional-mutating-and-summarising.html#cb361-1" aria-hidden="true" tabindex="-1"></a>broadway</span>
<span id="cb361-2"><a href="conditional-mutating-and-summarising.html#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 47,524 × 8</span></span>
<span id="cb361-3"><a href="conditional-mutating-and-summarising.html#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    week_ending show   theatre  weekly_gross avg_ticket_price</span></span>
<span id="cb361-4"><a href="conditional-mutating-and-summarising.html#cb361-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;date&gt;      &lt;chr&gt;  &lt;chr&gt;           &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb361-5"><a href="conditional-mutating-and-summarising.html#cb361-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 1985-06-09  42nd … St. Jam…       282368             30.4</span></span>
<span id="cb361-6"><a href="conditional-mutating-and-summarising.html#cb361-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 1985-06-09  A Cho… Sam S. …       222584             27.2</span></span>
<span id="cb361-7"><a href="conditional-mutating-and-summarising.html#cb361-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 1985-06-09  Aren&#39;… Brooks …       249272             33.8</span></span>
<span id="cb361-8"><a href="conditional-mutating-and-summarising.html#cb361-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 1985-06-09  Arms … Circle …        95688             20.9</span></span>
<span id="cb361-9"><a href="conditional-mutating-and-summarising.html#cb361-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 1985-06-09  As Is  Lyceum …        61059             20.8</span></span>
<span id="cb361-10"><a href="conditional-mutating-and-summarising.html#cb361-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 1985-06-09  Big R… Eugene …       255386             32.0</span></span>
<span id="cb361-11"><a href="conditional-mutating-and-summarising.html#cb361-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 1985-06-09  Bilox… Neil Si…       306839             28.3</span></span>
<span id="cb361-12"><a href="conditional-mutating-and-summarising.html#cb361-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 1985-06-09  Brigh… 46th St…       107392             18.9</span></span>
<span id="cb361-13"><a href="conditional-mutating-and-summarising.html#cb361-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 1985-06-09  Cats   Winter …       461880             38.4</span></span>
<span id="cb361-14"><a href="conditional-mutating-and-summarising.html#cb361-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 1985-06-09  Doubl… Ritz Th…        47452             17.5</span></span>
<span id="cb361-15"><a href="conditional-mutating-and-summarising.html#cb361-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 47,514 more rows, and 3 more variables:</span></span>
<span id="cb361-16"><a href="conditional-mutating-and-summarising.html#cb361-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   top_ticket_price &lt;dbl&gt;, performances &lt;dbl&gt;,</span></span>
<span id="cb361-17"><a href="conditional-mutating-and-summarising.html#cb361-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   previews &lt;dbl&gt;</span></span></code></pre></div>
<div id="question-1-6" class="section level3" number="56.3.1">
<h3><span class="header-section-number">56.3.1</span> Question 1</h3>
<p>What is the minimum and maximum number of performances <em>and</em> previews per week? We can use
<code>across()</code> to select specific columns to summarize them with multiple summary functions.</p>
<pre><code class='language-r'><code>broadway %>%<br>&nbsp;&nbsp;group_by(week_ending) %>%<br>&nbsp;&nbsp;summarise(<span style='color:blue'>across</span>(<span style='color:deeppink'>.cols</span> = c("performances", "previews"),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='color:orange'>.fns</span> = list(min = min, max = max)),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.groups = 'drop')<br>#> # A tibble: 1,812 × 5<br>#> &nbsp;&nbsp;&nbsp;week_ending performances_min performances_max<br>#> &nbsp;&nbsp;&nbsp;<date> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<dbl> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<dbl><br>#> &nbsp;1 1985-06-09 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9<br>#> &nbsp;2 1985-06-16 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8<br>#> &nbsp;3 1985-06-23 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9<br>#> &nbsp;4 1985-06-30 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9<br>#> &nbsp;5 1985-07-07 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9<br>#> &nbsp;6 1985-07-14 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9<br>#> &nbsp;7 1985-07-21 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9<br>#> &nbsp;8 1985-07-28 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9<br>#> &nbsp;9 1985-08-04 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9<br>#> 10 1985-08-11 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9<br>#> # … with 1,802 more rows, and 2 more variables:<br>#> # &nbsp;&nbsp;previews_min <dbl>, previews_max <dbl></code></code></pre>
<p>Here is what the above chunk of code does:</p>
<ul>
<li>Groups the data by week using <code>group_by()</code></li>
<li>Selects columns to summarize by passing a vector to <code>.cols</code> in <code>across()</code> (Highlighted in pink)</li>
<li>Defines summary functions by passing a list to <code>.fns</code> in <code>across()</code> (Highlighted in orange)</li>
</ul>
<p>You can also learn more about <code>across()</code> by running <code>?across</code> in your console.</p>
</div>
<div id="question-2-5" class="section level3" number="56.3.2">
<h3><span class="header-section-number">56.3.2</span> Question 2</h3>
<p>How do we provide a numeric summary for every show happening in a particular week?</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="conditional-mutating-and-summarising.html#cb362-1" aria-hidden="true" tabindex="-1"></a>broadway <span class="sc">%&gt;%</span></span>
<span id="cb362-2"><a href="conditional-mutating-and-summarising.html#cb362-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(week_ending, show) <span class="sc">%&gt;%</span></span>
<span id="cb362-3"><a href="conditional-mutating-and-summarising.html#cb362-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb362-4"><a href="conditional-mutating-and-summarising.html#cb362-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb362-5"><a href="conditional-mutating-and-summarising.html#cb362-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 47,524 × 7</span></span>
<span id="cb362-6"><a href="conditional-mutating-and-summarising.html#cb362-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    week_ending show                   weekly_gross avg_ticket_price</span></span>
<span id="cb362-7"><a href="conditional-mutating-and-summarising.html#cb362-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;date&gt;      &lt;chr&gt;                         &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb362-8"><a href="conditional-mutating-and-summarising.html#cb362-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 1985-06-09  42nd Street                  282368             30.4</span></span>
<span id="cb362-9"><a href="conditional-mutating-and-summarising.html#cb362-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 1985-06-09  A Chorus Line                222584             27.2</span></span>
<span id="cb362-10"><a href="conditional-mutating-and-summarising.html#cb362-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 1985-06-09  Aren&#39;t We All?               249272             33.8</span></span>
<span id="cb362-11"><a href="conditional-mutating-and-summarising.html#cb362-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 1985-06-09  Arms and the Man              95688             20.9</span></span>
<span id="cb362-12"><a href="conditional-mutating-and-summarising.html#cb362-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 1985-06-09  As Is                         61059             20.8</span></span>
<span id="cb362-13"><a href="conditional-mutating-and-summarising.html#cb362-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 1985-06-09  Big River                    255386             32.0</span></span>
<span id="cb362-14"><a href="conditional-mutating-and-summarising.html#cb362-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 1985-06-09  Biloxi Blues                 306839             28.3</span></span>
<span id="cb362-15"><a href="conditional-mutating-and-summarising.html#cb362-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 1985-06-09  Brighton Beach Memoirs       107392             18.9</span></span>
<span id="cb362-16"><a href="conditional-mutating-and-summarising.html#cb362-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 1985-06-09  Cats                         461880             38.4</span></span>
<span id="cb362-17"><a href="conditional-mutating-and-summarising.html#cb362-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 1985-06-09  Doubles                       47452             17.5</span></span>
<span id="cb362-18"><a href="conditional-mutating-and-summarising.html#cb362-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 47,514 more rows, and 3 more variables:</span></span>
<span id="cb362-19"><a href="conditional-mutating-and-summarising.html#cb362-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   top_ticket_price &lt;dbl&gt;, performances &lt;dbl&gt;,</span></span>
<span id="cb362-20"><a href="conditional-mutating-and-summarising.html#cb362-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   previews &lt;dbl&gt;</span></span></code></pre></div>
<p>This chunk of code summarizes every show happening in some particular week by every
numeric variable that is available in the data set. This helps us compute things like
the average ticket price and the number of performances each show had in a particular
week.</p>
</div>
<div id="question-3-5" class="section level3" number="56.3.3">
<h3><span class="header-section-number">56.3.3</span> Question 3</h3>
<p>We can use mutate() and if_else() to change values within a column. For example, here
is what we would write if we wanted to change all rows with theatre Studio 54 to be
called Studio 54 Theatre.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="conditional-mutating-and-summarising.html#cb363-1" aria-hidden="true" tabindex="-1"></a>broadway <span class="sc">%&gt;%</span> </span>
<span id="cb363-2"><a href="conditional-mutating-and-summarising.html#cb363-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">theatre =</span> <span class="fu">if_else</span>(theatre <span class="sc">==</span> <span class="st">&quot;Studio 54&quot;</span>, <span class="st">&quot;Studio 54 Theatre&quot;</span>, theatre))</span>
<span id="cb363-3"><a href="conditional-mutating-and-summarising.html#cb363-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 47,524 × 8</span></span>
<span id="cb363-4"><a href="conditional-mutating-and-summarising.html#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    week_ending show   theatre  weekly_gross avg_ticket_price</span></span>
<span id="cb363-5"><a href="conditional-mutating-and-summarising.html#cb363-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;date&gt;      &lt;chr&gt;  &lt;chr&gt;           &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb363-6"><a href="conditional-mutating-and-summarising.html#cb363-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 1985-06-09  42nd … St. Jam…       282368             30.4</span></span>
<span id="cb363-7"><a href="conditional-mutating-and-summarising.html#cb363-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 1985-06-09  A Cho… Sam S. …       222584             27.2</span></span>
<span id="cb363-8"><a href="conditional-mutating-and-summarising.html#cb363-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 1985-06-09  Aren&#39;… Brooks …       249272             33.8</span></span>
<span id="cb363-9"><a href="conditional-mutating-and-summarising.html#cb363-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 1985-06-09  Arms … Circle …        95688             20.9</span></span>
<span id="cb363-10"><a href="conditional-mutating-and-summarising.html#cb363-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 1985-06-09  As Is  Lyceum …        61059             20.8</span></span>
<span id="cb363-11"><a href="conditional-mutating-and-summarising.html#cb363-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 1985-06-09  Big R… Eugene …       255386             32.0</span></span>
<span id="cb363-12"><a href="conditional-mutating-and-summarising.html#cb363-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 1985-06-09  Bilox… Neil Si…       306839             28.3</span></span>
<span id="cb363-13"><a href="conditional-mutating-and-summarising.html#cb363-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 1985-06-09  Brigh… 46th St…       107392             18.9</span></span>
<span id="cb363-14"><a href="conditional-mutating-and-summarising.html#cb363-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 1985-06-09  Cats   Winter …       461880             38.4</span></span>
<span id="cb363-15"><a href="conditional-mutating-and-summarising.html#cb363-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 1985-06-09  Doubl… Ritz Th…        47452             17.5</span></span>
<span id="cb363-16"><a href="conditional-mutating-and-summarising.html#cb363-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 47,514 more rows, and 3 more variables:</span></span>
<span id="cb363-17"><a href="conditional-mutating-and-summarising.html#cb363-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   top_ticket_price &lt;dbl&gt;, performances &lt;dbl&gt;,</span></span>
<span id="cb363-18"><a href="conditional-mutating-and-summarising.html#cb363-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   previews &lt;dbl&gt;</span></span></code></pre></div>
<p>We can confirm this by filtering for these theatre names.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="conditional-mutating-and-summarising.html#cb364-1" aria-hidden="true" tabindex="-1"></a>broadway <span class="sc">%&gt;%</span></span>
<span id="cb364-2"><a href="conditional-mutating-and-summarising.html#cb364-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">theatre =</span> <span class="fu">if_else</span>(theatre <span class="sc">==</span> <span class="st">&quot;Studio 54&quot;</span>, <span class="st">&quot;Studio 54 Theatre&quot;</span>, theatre)) <span class="sc">%&gt;%</span></span>
<span id="cb364-3"><a href="conditional-mutating-and-summarising.html#cb364-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(theatre <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Studio 54&quot;</span>, <span class="st">&quot;Studio 54 Theatre&quot;</span>))</span>
<span id="cb364-4"><a href="conditional-mutating-and-summarising.html#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 787 × 8</span></span>
<span id="cb364-5"><a href="conditional-mutating-and-summarising.html#cb364-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    week_ending show    theatre weekly_gross avg_ticket_price</span></span>
<span id="cb364-6"><a href="conditional-mutating-and-summarising.html#cb364-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;date&gt;      &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb364-7"><a href="conditional-mutating-and-summarising.html#cb364-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 1998-02-15  Cabaret Studio…        48008             58.4</span></span>
<span id="cb364-8"><a href="conditional-mutating-and-summarising.html#cb364-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 1998-02-22  Cabaret Studio…       172373             51.5</span></span>
<span id="cb364-9"><a href="conditional-mutating-and-summarising.html#cb364-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 1998-03-01  Cabaret Studio…       174178             50.8</span></span>
<span id="cb364-10"><a href="conditional-mutating-and-summarising.html#cb364-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 1998-03-08  Cabaret Studio…       177623             49.3</span></span>
<span id="cb364-11"><a href="conditional-mutating-and-summarising.html#cb364-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 1998-03-15  Cabaret Studio…       147752             48.3</span></span>
<span id="cb364-12"><a href="conditional-mutating-and-summarising.html#cb364-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 1998-03-22  Cabaret Studio…       151753             49.1</span></span>
<span id="cb364-13"><a href="conditional-mutating-and-summarising.html#cb364-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 1998-03-29  Cabaret Studio…       183802             48.7</span></span>
<span id="cb364-14"><a href="conditional-mutating-and-summarising.html#cb364-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 1998-04-05  Cabaret Studio…       194515             50.8</span></span>
<span id="cb364-15"><a href="conditional-mutating-and-summarising.html#cb364-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 1998-04-12  Cabaret Studio…       219786             54.2</span></span>
<span id="cb364-16"><a href="conditional-mutating-and-summarising.html#cb364-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 1998-04-19  Cabaret Studio…       196320             48.1</span></span>
<span id="cb364-17"><a href="conditional-mutating-and-summarising.html#cb364-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 777 more rows, and 3 more variables:</span></span>
<span id="cb364-18"><a href="conditional-mutating-and-summarising.html#cb364-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   top_ticket_price &lt;dbl&gt;, performances &lt;dbl&gt;,</span></span>
<span id="cb364-19"><a href="conditional-mutating-and-summarising.html#cb364-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   previews &lt;dbl&gt;</span></span></code></pre></div>
<p>Notice that we did not save the initial modified data frame. We are also using a new
operator %in% which checks for the value Studio 54 in a vector of values including
Studio 54 and Studio 54 Theatre.</p>
</div>
</div>
<div id="arguments-15" class="section level2" number="56.4">
<h2><span class="header-section-number">56.4</span> Arguments</h2>
<div id="across" class="section level3" number="56.4.1">
<h3><span class="header-section-number">56.4.1</span> <code>across()</code></h3>
<p>The <code>across()</code> function takes the following as arguments:</p>
<table>
<thead>
<tr class="header">
<th>Argument</th>
<th>Parameter</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>.fns</td>
<td></td>
<td>can pass a list of functions or a single function</td>
</tr>
<tr class="even">
<td>.cols</td>
<td>vector</td>
<td>vector with column names to apply functions to</td>
</tr>
</tbody>
</table>
<p>You can read more about the arguments in the <code>across()</code> function documentation
<a href="https://dplyr.tidyverse.org/reference/across.html">here</a>. Please note that the arguments
for across() will also depend on your use case.</p>
</div>
<div id="mutate_if" class="section level3" number="56.4.2">
<h3><span class="header-section-number">56.4.2</span> <code>mutate_if()</code></h3>
<p>The <code>mutate_if()</code> function takes the following as arguments:</p>
<table>
<thead>
<tr class="header">
<th>Argument</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>selection</td>
<td>selection of variables by type, i.e., is.character</td>
</tr>
<tr class="even">
<td>function</td>
<td>function to apply to the selection of variables</td>
</tr>
</tbody>
</table>
<p>You can read more about the arguments in the <code>mutate_if()</code> function documentation
<a href="https://dplyr.tidyverse.org/reference/mutate_all.html">here</a>.</p>
</div>
<div id="na_if" class="section level3" number="56.4.3">
<h3><span class="header-section-number">56.4.3</span> <code>na_if()</code></h3>
<p>The <code>na_if()</code> function takes the following as arguments:</p>
<table>
<thead>
<tr class="header">
<th>Argument</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>vector</td>
<td>vector to look for values we want to change</td>
</tr>
<tr class="even">
<td>value</td>
<td>value in the vector that we want to change to NA</td>
</tr>
</tbody>
</table>
<p>You can read more about the arguments in the <code>na_if()</code> function documentation
<a href="https://dplyr.tidyverse.org/reference/na_if.html">here</a>.</p>
<p>You can read more about <code>if_else()</code> in the corresponding tutorial on conditional
statements.</p>
</div>
</div>
<div id="exercises-31" class="section level2" number="56.5">
<h2><span class="header-section-number">56.5</span> Exercises</h2>
<div id="exercise-1-16" class="section level3" number="56.5.1">
<h3><span class="header-section-number">56.5.1</span> Exercise 1</h3>
<p>Count the number of distinct shows and distinct theatres using summarise() and across().
As a tip, try to use the data type for shows and theatres columns.</p>
</div>
<div id="exercise-2-13" class="section level3" number="56.5.2">
<h3><span class="header-section-number">56.5.2</span> Exercise 2</h3>
<p>Use the mutate_if() function to select all the variables of type double and convert them
to character.</p>
</div>
<div id="exercise-3-8" class="section level3" number="56.5.3">
<h3><span class="header-section-number">56.5.3</span> Exercise 3</h3>
<p>There are some shows with a value of [title of show] under the show column. Use the
na_if() conditional statement within mutate() to convert this to NA.</p>
</div>
</div>
<div id="next-steps-33" class="section level2" number="56.6">
<h2><span class="header-section-number">56.6</span> Next Steps</h2>
<p>If you would like to learn more about the functions in this tutorial, you may find the
following resource helpful:</p>
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/across.html">dplyr: Apply a function (or functions) across multiple
columns</a></li>
<li><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">Mutate multiple columns</a></li>
<li><a href="https://dplyr.tidyverse.org/reference/na_if.html">Convert values to NA</a></li>
</ul>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>DoSS Toolkit</strong>" was written by Various authors. It was last built on 2021-09-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
